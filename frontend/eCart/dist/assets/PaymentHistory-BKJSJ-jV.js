import{_ as k,r as S,a as m,o as b,c as o,b as s,F as v,d as N,e,f as T,g as i,t as r,n as _,h}from"./index-CD_oPiSF.js";const x={class:"history-container"},C={key:0,class:"no-history"},H={key:1,class:"history-list"},P=["onClick","disabled"],I={__name:"PaymentHistory",setup(F){const d=S([]),u=m({}),y=()=>{const a=JSON.parse(localStorage.getItem("paymentHistory"))||[];d.value=a},p=a=>a==="Pending"?"pending":a==="Completed"?"completed":"failed",f=async a=>{try{u[a.transactionToken]=!0;const n=(await h.post("https://paymentgatewayintegration.onrender.com/api/status",{token:a.transactionToken})).data.transaction_status||"Pending";a.transactionStatus=n;const l=JSON.parse(localStorage.getItem("paymentHistory"))||[],c=l.findIndex(g=>g.transactionToken===a.transactionToken);c>-1&&(l[c].transactionStatus=n,localStorage.setItem("paymentHistory",JSON.stringify(l)))}catch(t){console.error("Failed to fetch status",t)}finally{u[a.transactionToken]=!1}};return b(()=>{y()}),(a,t)=>(e(),o("div",x,[t[6]||(t[6]=s("h2",null,"Payment History",-1)),d.value.length===0?(e(),o("div",C," No transaction history found. ")):(e(),o("div",H,[(e(!0),o(v,null,N(d.value,(n,l)=>(e(),o("div",{key:l,class:"history-card"},[s("p",null,[t[0]||(t[0]=s("b",null,"Product:",-1)),i(" "+r(n.productName),1)]),s("p",null,[t[1]||(t[1]=s("b",null,"Quantity:",-1)),i(" "+r(n.quantity),1)]),s("p",null,[t[2]||(t[2]=s("b",null,"Amount:",-1)),i(" â‚¹"+r(n.amount),1)]),s("p",null,[t[3]||(t[3]=s("b",null,"Date:",-1)),i(" "+r(n.date),1)]),s("p",null,[t[4]||(t[4]=s("b",null,"Status:",-1)),t[5]||(t[5]=i()),s("span",{class:_(p(n.transactionStatus))},r(n.transactionStatus),3)]),n.transactionStatus==="Pending"?(e(),o("button",{key:0,onClick:c=>f(n),disabled:u[n.transactionToken]},r(u[n.transactionToken]?"Checking...":"Fetch Status"),9,P)):T("",!0)]))),128))]))]))}},J=k(I,[["__scopeId","data-v-92ffbf14"]]);export{J as default};
